{% load django_bootstrap5 %}
{% load i18n %}
{% load tz %}
{% load SO_custom_filters %}


{% block content %}
{% settings_value "TIME_ZONE" as time_zone %}

<div class="modal-content">
    <div class="modal-header bg-primary text-white">
        <h4 class="modal-title" id="access_log_label">
            {% translate "Access log" %}
        </h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
        {% if log %}
        <table class="table table-sm small">
            <thead class="table-light">
                <tr>
                    <th scope="col">{% translate "Date" %}</th>
                    <th scope="col">{% translate "User" %}</th>
                    <th scope="col">{% translate "Action" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for record in log %}
                {% timezone time_zone %}
                <tr>
                    <td>
                        {{record.timestamp|date:"d M Y, H:i" }}
                    </td>
                    <td>
                        {% if record.user %}
                        {{record.user.get_full_name }}
                        {% else %}
                        {{record.user__full_name }}
                        {% endif %}
                    </td>
                    <td>{{record.action }}</td>
                </tr>
                {% endtimezone %}
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <h2 class="text-center">
            {% translate "No entries" %}
        </h2>
        {% endif %}
    </div>
</div>
{% endblock %}
